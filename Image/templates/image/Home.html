{% extends "image/base.html" %}

{% block content %}
{% load static %}

    
    <div class="container-fluid">
    
        <div class="row">
          <div class="col-lg-2 col-md-4 mt-4">
            <div class="card  mb-3" >
              <div class="card-header text-bg-dark">
               Albums
              </div>
              <ul class="list-group list-group-flush">
               {% for Album in Albums  %}
               
               <li class="list-group-item">
                <a href="{% url 'AlbumView' %}?aid={{Album.id}}" style="text-decoration: none; color: black; font-weight: bold;">{{Album.AlbumName}}</a>
              </li>
               {% endfor %} 
               
                <li class="list-group-item"><a href="{% url 'Trash' %}" style="text-decoration: none; color: black; font-weight: bold;">Trash</a></li>

                
              </ul>
              <div class="card-footer">
                <a href="{% url 'AddAlbum' %}"  class = "btn btn-dark mt-2" >Add Album</a>
                <a href="{% url 'Upload' %}"  class =  "btn btn-dark mt-2" >Upload Image</a>
  
              </div>
            </div>
          </div>
          <div class="col-lg-10">
            <div class="row justify-content-start">
  
              <div class="col-lg-6">
                <form action="{% url 'BulkAction' %}" method="post" class="row">
                  
                  <div class="col-lg-3 mt-4">
                    <input type="checkbox" class="btn-check" id="btn-check-outlined" name="Select" autocomplete="off">
                    <label class="btn btn-outline-dark" for="btn-check-outlined">Select</label>
                  </div>
            
                 
            
                  <div class="col-lg-3 mt-4 option" style="display: none;">
                    <input type="hidden" name="Imgidlist" id="Imgidlist" value="[]">
                    <input type="hidden" name="Page" value="Home">

                    {% csrf_token %}
                    <input type="submit" name="Action" value="Trash" class="btn btn-dark" id="optionbutton">
                  </div>
            
                </form>
              </div>
            
            </div>
            
            
            <div class="row justify-content-start">
              {% for Img in Images %}
                  <div class="col-lg-2 col-4 mt-4 mb-4">
                      <a href="{% url 'ImageView' %}?i={{Img.id}}">
                          <div class="square-box">
                              <img src="{{ Img.Image.url }}" alt="" class="rounded">
                          </div>
                      </a>
                      <input type="checkbox" class="form-check-control mt-2 Imgid" style="color: black; font-size: 16px; display: none;" value="{{ Img.id }}">
                  </div>
              {% endfor %}

            </div>
          </div>
          
          
          </div>
        </div>  
  
       </div>
       <script>
        const select = document.getElementById('btn-check-outlined');
        const hiddenField = document.getElementById('Imgidlist');
        const checkboxes = document.querySelectorAll('.Imgid');
        const option = document.querySelectorAll('.option');
        
        let isVisible = false; 
    
        hiddenField.value = JSON.stringify([]);
    
        if (select) {
            select.addEventListener('click', function () {
                isVisible = !isVisible;
    
                option.forEach(opt => {
                    opt.style.display = isVisible ? 'block' : 'none';
                });
    
                checkboxes.forEach(checkbox => {
                    checkbox.style.display = isVisible ? 'block' : 'none';
    
                    if (!isVisible) {
                        checkbox.checked = false;
                    }
                });
    
                if (!isVisible) {
                    hiddenField.value = JSON.stringify([]);
                    console.log('Checkboxes hidden, ImgId list cleared');
                }
            });
        }
    
        checkboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function () {
                let selectedIds = JSON.parse(hiddenField.value || '[]');
    
                if (this.checked) {
                    if (!selectedIds.includes(this.value)) {
                        selectedIds.push(this.value);
                    }
                } else {
                    selectedIds = selectedIds.filter(id => id !== this.value);
                }
    
                hiddenField.value = JSON.stringify(selectedIds);
                console.log('Selected IDs:', selectedIds);
            });
        });
    </script>
    
        
    
      
{% endblock content %}


